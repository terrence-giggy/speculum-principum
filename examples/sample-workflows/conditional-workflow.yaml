# Conditional Workflow Example
# Advanced workflow that adapts based on issue characteristics and labels

name: "Adaptive Analysis Workflow"
description: "Adaptive workflow that selects deliverables based on issue characteristics"
version: "1.0.0"

# Labels that trigger this workflow
trigger_labels:
  - "adaptive"
  - "analysis"
  - "multi-purpose"

# Output configuration
output:
  folder_structure: "study/{issue_number}/adaptive-analysis"
  file_naming: "{deliverable_name}_{workflow_name}.md"
  branch_naming: "adaptive-{issue_number}"

# Conditional deliverables based on issue characteristics
deliverables:
  # Always generated
  - name: "initial_assessment"
    template: "base_deliverable.md"
    required: true
    description: "Initial problem assessment and scope definition"
    
  # Generated for urgent issues
  - name: "immediate_actions"
    template: "base_deliverable.md"
    required: false
    description: "Immediate actions for urgent issues"
    conditions:
      labels_include: ["urgent", "critical"]
      
  # Generated for security-related issues
  - name: "security_implications"
    template: "research_analysis.md"
    required: false
    description: "Security analysis and risk assessment"
    conditions:
      labels_include: ["security", "vulnerability"]
      
  # Generated for performance issues
  - name: "performance_analysis"
    template: "research_analysis.md"
    required: false
    description: "Performance impact analysis and optimization recommendations"
    conditions:
      labels_include: ["performance", "optimization"]
      
  # Generated for complex issues
  - name: "comprehensive_analysis"
    template: "research_analysis.md"
    required: false
    description: "Deep dive analysis for complex problems"
    conditions:
      labels_include: ["complex", "investigation"]
      issue_body_length: "> 1000"
      
  # Generated for stakeholder review
  - name: "stakeholder_summary"
    template: "base_deliverable.md"
    required: false
    description: "Executive summary for stakeholder review"
    conditions:
      labels_include: ["stakeholder-review", "leadership"]
      
  # Always generated as final step
  - name: "recommendations"
    template: "base_deliverable.md"
    required: true
    description: "Final recommendations and next steps"

# Adaptive processing configuration
processing:
  # Basic settings
  include_citations: true
  format: "markdown"
  
  # Conditional processing depth
  research_depth: |
    {% if 'urgent' in issue.labels %}basic
    {% elif 'complex' in issue.labels %}comprehensive
    {% else %}standard{% endif %}
    
  # Conditional time limits
  max_processing_time: |
    {% if 'urgent' in issue.labels %}1800
    {% elif 'complex' in issue.labels %}7200
    {% else %}3600{% endif %}
    
  # Dynamic focus areas
  focus_areas: |
    {% set areas = ['problem_analysis', 'solution_options'] %}
    {% if 'security' in issue.labels %}
      {% set _ = areas.append('security_assessment') %}
    {% endif %}
    {% if 'performance' in issue.labels %}
      {% set _ = areas.append('performance_impact') %}
    {% endif %}
    {% if 'user-experience' in issue.labels %}
      {% set _ = areas.append('ux_considerations') %}
    {% endif %}
    {{ areas }}
    
  estimated_duration: |
    {% if 'urgent' in issue.labels %}1 hour
    {% elif 'complex' in issue.labels %}4-6 hours
    {% else %}2-3 hours{% endif %}

# Adaptive validation rules
validation:
  # Base requirements
  required_sections: ["Assessment", "Analysis", "Recommendations"]
  spell_check: true
  
  # Conditional content length
  min_content_length: |
    {% if 'urgent' in issue.labels %}500
    {% elif 'comprehensive' in issue.labels %}3000
    {% else %}1500{% endif %}
    
  # Conditional review requirements
  peer_review_required: |
    {% if 'critical' in issue.labels or 'security' in issue.labels %}true
    {% else %}false{% endif %}